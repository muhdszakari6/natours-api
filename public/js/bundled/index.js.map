{"mappings":"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","sources":["public/js/alert.js","public/js/login.js","public/js/mapbox.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["export const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  setTimeout(() => {\n    hideAlert();\n  }, 5000);\n};\n","import axios from 'axios';\nimport { showAlert } from './alert';\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password,\n      },\n    });\n    if (res.data.status === 'success') {\n      showAlert('success', `Logged in successfully`);\n      setTimeout(() => {\n        window.location.assign('/');\n      }, 1500);\n    }\n  } catch (error) {\n    showAlert('error', error.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout',\n    });\n    if (res.data.status === 'success') location.reload(true);\n  } catch (error) {\n    showAlert('error', 'Error logging out.');\n  }\n};\n","/* eslint-disable */\n\nexport const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoic2FsaW16YWthcmkiLCJhIjoiY2w0MThodms5MGRzNDNlbnZ5OTJmZjZjMyJ9.evbFI31AJIVa51M_6f4DgQ';\n  const map = new mapboxgl.Map({\n    container: 'map', // container ID\n    style: 'mapbox://styles/salimzakari/cl41ay1n7001714n0sx7ftup1', // style URL\n    // center: [], // starting position [lng, lat]\n    // zoom: 9, // starting zoom\n    // interactive: false,\n    scrollZoom: false,\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((loc) => {\n    //Create marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom',\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popoup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(\n        `\n        <p>Day ${loc.day}: ${loc.description}</p>\n    `\n      )\n      .addTo(map);\n\n    //Extends map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n  map.fitBounds(bounds, {\n    padding: { top: 200, left: 100, right: 100, bottom: 200 },\n  });\n};\n","import axios from 'axios';\nimport { showAlert } from './alert';\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updateMyPassword'\n        : '/api/v1/users/updateMe';\n    const res = await axios({\n      method: 'PATCH',\n      url: url,\n      data: data,\n    });\n    if (res.data.status === 'success') {\n      showAlert('success', ` ${type.toUpperCase()} Updated successfully`);\n    }\n  } catch (error) {\n    showAlert('error', error.response.data.message);\n  }\n};\n","import axios from 'axios';\nimport { showAlert } from './alert';\n\nexport const bookTour = async (tourId) => {\n  const stripe = Stripe(\n    'pk_test_51LALqfBjweXZCTdyRp7LLriP1BB82eaiqPT1k30L5gK8pzpt5cL6PQMlHabrcEpMs4GVzeeU51TiM8EcasoDguBF00TrwnymJU'\n  );\n\n  try {\n    //Get the session from the server\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n\n    //Use Stipe to create checkout form\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (error) {\n    console.log(err);\n    showAlert('error', err);\n  }\n};\n","/* eslint-disable */\nvar require = window.require;\nimport '@babel/polyfill';\nimport { login, logout } from './login';\nimport { displayMap } from './mapbox';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\n\nconst mapbox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\n\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst bookTourBtn = document.getElementById('book-tour');\n\nif (mapbox) {\n  const locations = JSON.parse(mapbox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n}\n\nif (userDataForm) {\n  userDataForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n    await updateSettings(form, 'data');\n  });\n}\n\nif (userPasswordForm) {\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    document.querySelector('.btn--save-password').innerHTML = 'Updating';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { password, passwordConfirm, passwordCurrent },\n      'password'\n    );\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n    document.querySelector('.btn--save-password').innerHTML = 'Save Password';\n  });\n}\n\nif (logOutBtn) {\n  logOutBtn.addEventListener('click', logout);\n}\n\nif (bookTourBtn) {\n  bookTourBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n}\n"],"names":["$e9c91518574fdb31$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$e9c91518574fdb31$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$cnf0l$axios","method","url","data","status","window","location","assign","error","response","message","$3c4e158d14605c12$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","left","right","bottom","$955535ce7513e32c$export$f558026a994b6051","toUpperCase","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","console","log","err","require","$407eccdc61ba7a94$var$mapbox","getElementById","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$userDataForm","$407eccdc61ba7a94$var$userPasswordForm","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$bookTourBtn","JSON","parse","dataset","addEventListener","e","preventDefault","value","form","FormData","append","files","innerHTML","passwordCurrent","passwordConfirm","reload","target","textContent"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}